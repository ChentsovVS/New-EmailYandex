New-EmailYandex

	Функция позволяющая работать с API яндекс коннекта. Функционал:
	1. Создать пользователя с ручным вводом данных
	2. Создать пользователей* из csv 
	
	Описание параметров:
	
		-NickName
		Принимает string - вводим желаемый логин пользователя 

		-SurName
		Принимает string - фамилию пользователя 

		-FirstName
		Принимает string - имя пользователя 

		-Department
		Принимает int - отдел (у яндекс коннекта может быть несколько отделов
		Требуется ввести ID требующегося отдела. По стандарту используется общий (id = 1)) 

		-Password
		Принимает string - пароль пользователя 

		-WorkLine
		Принимает string - Флаг работы функции (делаем массовое создание из csv или создаем одиночный ящик)
		С помощью tab - можно переключать флаг 
		Флага 2 -   'OneUser' - создает одиночного пользователя.
                'MassUser' - массовое создание из файла csv 
            Пример csv файла:
                (
                i.ivanov;Иванов;Иван;Кредитный специалист
                p.petrov;Петров;Петр;Кредитный специалист
                )
            Headers  - NickName,SurName,FirstName,Position
		Важно - параметр обязательный
		
		-PathFile
		Принимает string - вводим месторасположение и имя файла 
		Пример: C:\temp\massemail.csv 

		-Token
		Принимает string - вводим токен, или вводим нужный токен в функцию напрямую 
		(в поле [string]$Token = "Paste_Youre_Token" - вместо Paste_Youre_Token)
	
	Что требуется для работы:
	1. Для создания пользователя нужны данные:
		1.1 никнейм (логин - например - i.ivanov) 
		1.2 фамилия 
		1.3 имя 
		1.4 отдел в который мы создадим пользователя (по стандарту = 1) 
		1.5 должность сотрудника
		1.6 токен от яндекс коннекта. 
		1.7 пароль (по стандарту - P@ssw0rd) 
		или
		1.8 CSV с данными 
		Пример csv файла:
                (
                i.ivanov;Иванов;Иван;Кредитный специалист
                p.petrov;Петров;Петр;Кредитный специалист
                )
            Headers  - NickName,SurName,FirstName,Position
		1.9 путь до csv 
	
	О вложенных файлах:
	1. users.csv - пример csv который нужен для работы массового создания пользователей
	2. 
	
	Как пользоваться:
	1. Открываем файл через ISE 
	2. Нажимаем f5
	3. Пишем:
	New-EmailYandex -NickName 'apitest' -SurName 'test' -FirstName 'api' -WorkLine OneUser -Position "Testing Specialist" -Password "P@ssw0rd" -Token "Paste_Youre_Token" -department 1
    Создаем одиночный почтовый ящик из функции с данными пользователя (логин, фамилия, имя, тип создания - одиночный пользователь, должность, пароль, токен)

	4. Если хотим создать массово пользователей - тогда:
    New-EmailYandex -WorkLine MassUser -Password "P@ssw0rd" -PathFile C:\temp\massemail.csv -Token "Paste_Youre_Token"
    Делаем массовое создание пользователей c паролем P@ssw0rd из csv файла C:\temp\massemail.csv с токеном "Paste_Youre_Token". 
            Пример csv файла:
                (
                i.ivanov;Иванов;Иван;Кредитный специалист
                p.petrov;Петров;Петр;Кредитный специалист
                )
            Headers  - NickName,SurName,FirstName,Position
	
	